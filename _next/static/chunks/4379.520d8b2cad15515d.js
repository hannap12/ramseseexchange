(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4379],{456029:function(e,t,n){var r=n(733448);e.exports=function(e,t,n){for(var o=-1,l=e.length;++o<l;){var u=e[o],c=t(u);if(null!=c&&(void 0===i?c==c&&!r(c):n(c,i)))var i=c,s=u}return s}},753325:function(e){e.exports=function(e,t){return e>t}},84753:function(e,t,n){var r=n(456029),o=n(753325),l=n(267206);e.exports=function(e,t){return e&&e.length?r(e,l(t,2),o):void 0}},238981:function(e,t,n){"use strict";n.d(t,{Xk:function(){return k},tA:function(){return h},uz:function(){return E}});var r=n(667294),o=n(277985),l=n(84753),u=n.n(l),c=n(802066),i=n(466151),s=n(331223),a=n(107449),f=n(454390),d=n(509401),m=n(519727),v=n(655755),b=n(852339);function h(){let e=(0,v.IK)(),t=(0,v.m4)(),{results:n,isLoading:l}=function(){let{chainId:e}=(0,o.useWeb3React)(),t=(0,r.useMemo)(()=>e?i.$P[e]:void 0,[e]);return(0,b.E)(t)}(),u=(0,r.useMemo)(()=>n?n.map(e=>[e]):[],[n.join(",")]),m=(0,c.es)(e,"locked",u),h=(0,c.es)(e,"balanceOfNFT",u),k=(0,c.es)(t,"lastVoted",u),E=(0,r.useMemo)(()=>l||m.some(e=>{let{loading:t}=e;return t})||h.some(e=>{let{loading:t}=e;return t})||k.some(e=>{let{loading:t}=e;return t}),[l,m,h,k]),p=(0,r.useMemo)(()=>m.some(e=>{let{error:t}=e;return t})||h.some(e=>{let{error:t}=e;return t})||k.some(e=>{let{error:t}=e;return t}),[m,h,k]),N=(0,r.useMemo)(()=>{if(!E&&!p&&n&&h.length>0&&k.length>0)return m.map((e,t)=>(function(e,t,n,r){var o,l,u,c;let i=(null!==(u=(0,a.E9)(e))&&void 0!==u?u:f.nw).div(1e18),m=null===(o=(0,a.E9)(e,1))||void 0===o?void 0:o.toNumber(),v=(null!==(c=(0,a.E9)(t))&&void 0!==c?c:f.nw).div(1e18),b=(null===(l=(0,a.E9)(n))||void 0===l?void 0:l.toNumber())||0;return{id:r,amount:i,lockEnd:m,balance:v,powerUsed:(0,d.z5)()-b<s.G4,voted:!0}})(e,h[t],k[t],u[t][0]))},[E,p,n,m,h,k,u]);return{loading:E,positions:N}}function k(){let{loading:e,positions:t}=(0,m.DA)(),n=u()(t,function(e){return e.balance.toNumber()});return(0,r.useMemo)(()=>e||0===t.length||!n?{tokenId:null,amount:f.nw}:{tokenId:n.id,amount:n.balance},[n,e,t.length])}function E(){let e=(0,v.IK)(),[t]=(0,c.Ky)(e,[{methodName:"totalSupply",callInputs:[]}]),n=(0,r.useMemo)(()=>{var e;return null!==(e=(0,a.E9)(t))&&void 0!==e?e:f.nw},[t]).div(1e18);return(0,r.useMemo)(()=>({totalSupply:n}),[n])}},514379:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return V}});var r=n(785893),o=n(667294),l=n(277985),u=n(655632),c=n(506119),i=n(637916),s=n(293625),a=n(249332),f=n(56657),d=n(238981),m=n(519727),v=n(68425),b=n(822602),h=n(666690),k=n(29534),E=n(267142);let p=async(e,t)=>{if((0,s.EC)(t)){if(e===h.LK.connector||e===h.ro.connector)await e.activate(t);else{let n=(0,k.b)(t),r={chainId:Number(t.toString()).toString(16),chainName:n.label,rpcUrls:[t===s.x8?E.vl[t][0]:E.yP[t][0]],nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorerUrl]};await e.activate(r)}}else throw Error("Chain ".concat(t," not supported for connector (").concat(typeof e,")"))};function N(){let{provider:e,chainId:t,account:n}=(0,l.useWeb3React)(),r=(0,u.TL)(),h=(0,c.Z)(),{loading:k}=(0,m.DA)(),E=(0,a.h3)(),N=(0,a.TA)(),{tokenId:I}=(0,d.Xk)(),g=!!(0,m.Dr)(null!=N?N:void 0),[w,C]=(0,o.useState)({chainId:t,blockNumber:null,blockTimestamp:null}),x=(0,o.useCallback)(e=>{C(n=>{if(t===n.chainId){var r,o;return"number"!=typeof n.blockNumber&&"number"!=typeof n.blockTimestamp?{chainId:t,blockNumber:e.number,blockTimestamp:e.timestamp}:{chainId:t,blockNumber:Math.max(e.number,null!==(r=n.blockNumber)&&void 0!==r?r:0),blockTimestamp:Math.max(e.timestamp,null!==(o=n.blockTimestamp)&&void 0!==o?o:0)}}return n})},[t,C]),L=(0,o.useCallback)(t=>e&&e.getBlock(t).then(x),[x,e]);(0,o.useEffect)(()=>{if(e&&t&&h)return C({chainId:t,blockNumber:null,blockTimestamp:null}),e.getBlock("latest").then(x).catch(e=>console.error("Failed to get block for chainId: ".concat(t),e)),e.on("block",L),()=>{e.removeListener("block",L)}},[r,t,e,h,x,L]);let M=(0,i.Z)(w,100);(0,o.useEffect)(()=>{M.chainId&&M.blockNumber&&h&&r((0,f.fG)({chainId:M.chainId,blockNumber:M.blockNumber}))},[h,r,M.blockNumber,M.chainId]),(0,o.useEffect)(()=>{M.chainId&&M.blockTimestamp&&h&&r((0,f.Vy)({chainId:M.chainId,blockTimestamp:M.blockTimestamp}))},[h,r,M.blockTimestamp,M.chainId]),(0,o.useEffect)(()=>{var e;r((0,f.vH)({chainId:M.chainId in s.HL&&null!==(e=M.chainId)&&void 0!==e?e:null}))},[r,M.chainId]);let T=function(){let e=(0,u.TL)(),{connector:t}=(0,l.useWeb3React)();return(0,o.useCallback)(async n=>{if(!t)return;let r=(0,v.B5)(t).type;try{e((0,b.o)({connectionType:r,error:void 0})),await p(t,n)}catch(t){console.error("Failed to switch networks",t),e((0,b.o)({connectionType:r,error:t.message})),e((0,f.i8)({content:{failedSwitchNetwork:n},key:"failed-network-switch"}))}},[t,e])}();return(0,o.useEffect)(()=>{t!==s.x8&&h&&T(s.x8)},[t,T,h]),(0,o.useEffect)(()=>{!I||k||g||E(I)},[E,I,k,N,g]),null}var I=n(331223),g=n(576588),w=n(868458);function C(e){let{pendingTransactions:t,onCheck:n,onReceipt:r}=e,{chainId:u,provider:c}=(0,l.useWeb3React)(),i=(0,g.ZP)(),s=(0,g.nj)(),a=(0,o.useCallback)(e=>{var t;if(!c||!u)throw Error("No provider or chainId");let n=null!==(t=I.p2[u])&&void 0!==t?t:I.Hb;return(0,w.XD)(()=>c.getTransactionReceipt(e).then(t=>{if(null===t)throw console.debug("Retrying transaction receipt for ".concat(e)),new w.s1;return t}),n)},[u,c]);return(0,o.useEffect)(()=>{if(!u||!c||!i)return;let e=Object.keys(t).filter(e=>(function(e,t){if(t.receipt)return!1;if(!t.lastCheckedBlockNumber)return!0;let n=e-t.lastCheckedBlockNumber;if(n<1)return!1;let r=(new Date().getTime()-t.addedTime)/6e4;return r>60?n>9:!(r>5)||n>2})(i,t[e])).map(e=>{let{promise:t,cancel:o}=a(e);return t.then(t=>{t?(s(t.blockNumber),r({chainId:u,hash:e,receipt:t})):n({chainId:u,hash:e,blockNumber:i})}).catch(t=>{t.isCancelledError||console.warn("Failed to get transaction receipt for ".concat(e),t)}),o});return()=>{e.forEach(e=>e())}},[u,c,i,a,r,n,t,s]),null}var x=n(217261);function L(){let{chainId:e}=(0,l.useWeb3React)(),t=!!(e&&s.Ny.includes(e)),n=(0,u.CG)(e=>e.transactions),c=(0,a.i$)(),i=(0,u.TL)(),f=(0,o.useCallback)(e=>{let{chainId:t,hash:n,blockNumber:r}=e;return i((0,x.LN)({chainId:t,hash:n,blockNumber:r}))},[i]),d=(0,o.useCallback)(e=>{var r;let{chainId:o,hash:l,receipt:u}=e;i((0,x.Aw)({chainId:o,hash:l,receipt:{blockHash:u.blockHash,blockNumber:u.blockNumber,contractAddress:u.contractAddress,from:u.from,status:u.status,to:u.to,transactionHash:u.transactionHash,transactionIndex:u.transactionIndex}})),c({txn:{hash:l,success:1===u.status,summary:null===(r=n[l])||void 0===r?void 0:r.summary}},l,t?I.Zc:I.U_)},[c,i,t,n]),m=(0,o.useMemo)(()=>{var t;return e&&null!==(t=n[e])&&void 0!==t?t:{}},[e,n]);return(0,r.jsx)(C,{pendingTransactions:m,onCheck:f,onReceipt:d})}var M=n(454390),T=n(517862),y=n(225352);function S(){let e=(0,u.TL)(),t=(0,y.o8)(),n=(0,y.NU)();return(0,o.useEffect)(()=>{(0,M.Md)(t).isNaN()&&n(2)},[t,n]),(0,o.useEffect)(()=>{var t;let n=t=>{e((0,T._I)({matchesDarkMode:t.matches}))},r=null===(t=window)||void 0===t?void 0:t.matchMedia("(prefers-color-scheme: dark)");return e((0,T._I)({matchesDarkMode:r.matches})),(null==r?void 0:r.addListener)?null==r||r.addListener(n):(null==r?void 0:r.addEventListener)&&(null==r||r.addEventListener("change",n)),()=>{(null==r?void 0:r.removeListener)?null==r||r.removeListener(n):(null==r?void 0:r.removeEventListener)&&(null==r||r.removeEventListener("change",n))}},[e]),null}var _=n(712314),D=n(860940);function R(){let e=(0,u.TL)(),t=(0,c.Z)(),n=(0,D.YX)(),r=(0,D.Ch)(),{account:i}=(0,l.useWeb3React)();return(0,o.useEffect)(()=>(0,w.lv)(()=>t?e((0,_.uv)()):void 0,30),[e,t]),(0,o.useEffect)(()=>(0,w.lv)(()=>t?e((0,_.OH)()):void 0,45),[e,t]),(0,o.useEffect)(()=>(0,w.lv)(()=>t?e((0,_.Vq)()):void 0,60),[e,t]),(0,o.useEffect)(()=>(0,w.lv)(()=>t?e((0,_.vB)()):void 0,60),[e,t]),(0,o.useEffect)(()=>(0,w.lv)(()=>t?e((0,_.gs)()):void 0,300),[e,t]),(0,o.useEffect)(()=>(0,w.lv)(()=>t&&i?e((0,_.wu)(i)):void 0,10),[e,t,i]),(0,o.useEffect)(()=>(0,w.lv)(()=>t&&(n.length>0||r)?e((0,_.fq)(r?[...n,r]:n)):void 0,60),[e,t,n,r]),null}var j=n(195555),O=n(618446),A=n.n(O),P=n(855568),H=n(545578),W=n.n(H),U=n(761709),B=n(619558),F=n(772316);let X={[F.I.CLOSED_CL_POSITION]:2.33};var Z=n(545737);function q(){let[e,t]=(0,o.useState)(0),n=Date.now(),{account:r}=(0,l.useWeb3React)(),c=n>e+2e3,[i,s]=function(e){let t=function(e){let t=(0,u.CG)(e=>e.global);return(0,o.useMemo)(()=>t[e],[t,e])}(e),n=X[e];return(0,o.useMemo)(()=>void 0===n?[!1,void 0]:[n>t,n],[n,t])}(F.I.CLOSED_CL_POSITION),a=function(){let e=(0,u.TL)();return(0,o.useCallback)((t,n)=>{e((0,B.S)({versionType:t,versionNumber:n}))},[e])}(),f=(0,D.VZ)(),d=(0,D.dx)(),m=(0,D.X5)(),v=(0,y.P_)(),b=(0,y.t3)(),h=(0,o.useMemo)(()=>b.map(e=>e.id).filter(e=>!m.includes(e)),[b,m]),[k,E]=(0,o.useState)([]),p=(0,o.useMemo)(()=>k.map(e=>e.id).filter(e=>!m.includes(e)),[k,m]),N=(0,D.$H)(),g=(0,D.KN)(),w=(0,D.VW)(),C=(0,D.og)(),x=(0,D.kD)(),{results:L,balance:M,isLoading:T}=(0,P.EM)();(0,o.useEffect)(()=>{x!==M&&C(M)},[M,C,x]),(0,o.useEffect)(()=>{C(M)},[M,C]);let S=L.filter(e=>!p.includes(e)&&!h.includes(e)),{positions:_,isLoading:R,isError:j}=(0,U.Ng)(S),O=(0,o.useMemo)(()=>_.filter(e=>(null==e?void 0:e.poolAddress)&&(null==e?void 0:e.liquidity.gt(0))),[_]),H=(0,o.useMemo)(()=>_.filter(e=>(null==e?void 0:e.poolAddress)&&(null==e?void 0:e.liquidity.eq(0))),[_]),[q,K]=(0,o.useState)(_),V=(0,o.useMemo)(()=>W()([...H,...b,...k],"id").filter(e=>!m.includes(e.id)),[H,b,k,m]);return(0,o.useEffect)(()=>{T||R||j||d===k.length>I.Nn||f(k.length>I.Nn)},[k.length,T,R,j,f,d]),(0,o.useEffect)(()=>{let e=V.filter(e=>L.includes(e.id));A()(k,e)||T||R||j||E(e)},[k,H,V,L,T,R,j]),(0,o.useEffect)(()=>{w(k)},[k,w]),(0,o.useEffect)(()=>{V.length>0&&!A()(b,V)&&v((0,Z.U)(V))},[V,b,k,v]),(0,o.useEffect)(()=>{!c||A()(q,O)||T||R||j||(console.log("updating NFPs:",O),K(O),t(n))},[O,q,c,T,R,j]),(0,o.useEffect)(()=>{A()(N,q)||g(q)},[q,g,N]),(0,o.useEffect)(()=>{g([]),E([]),C(0),K([]),t(0)},[r,g,C]),(0,o.useEffect)(()=>{!0===i&&s&&(a(F.I.CLOSED_CL_POSITION,s),v([]))},[s,v,a,i]),null}function K(){let{account:e}=(0,l.useWeb3React)(),t=(0,m.$f)(),n=(0,m.bi)(),{positions:r,loading:u}=(0,d.tA)(),[c,i]=(0,o.useState)(r||[]);return(0,o.useEffect)(()=>{r&&!A()(c,r)&&i(r)},[r,c,e]),(0,o.useEffect)(()=>{t(c)},[c,t]),(0,o.useEffect)(()=>{i([])},[e]),(0,o.useEffect)(()=>{n(u)},[n,u]),null}function V(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N,{}),(0,r.jsx)(L,{}),(0,r.jsx)(S,{}),(0,r.jsx)(j.v,{}),(0,r.jsx)(R,{}),(0,r.jsx)(K,{}),(0,r.jsx)(q,{})]})}},868458:function(e,t,n){"use strict";function r(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];n&&e();let r=setInterval(()=>{e()},1e3*t);return()=>clearInterval(r)}n.d(t,{XD:function(){return u},lv:function(){return r},s1:function(){return l}});class o extends Error{constructor(){super("Cancelled"),this.isCancelledError=!0}}class l extends Error{constructor(...e){super(...e),this.isRetryableError=!0}}function u(e,t){let n,{n:r,minWait:l,maxWait:u}=t,c=!1;return{promise:new Promise(async(t,o)=>{for(n=o;;){let n;try{n=await e(),c||(t(n),c=!0);break}catch(e){if(c)break;if(r<=0||!e.isRetryableError){o(e),c=!0;break}r--}await function(e,t){var n;return n=e+Math.round(Math.random()*Math.max(0,t-e)),new Promise(e=>setTimeout(e,n))}(l,u)}}),cancel:()=>{c||(c=!0,n(new o))}}}}}]);